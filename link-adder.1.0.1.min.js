/*
*	Link Adder 1.0.1
*	WordPress Plugin / Bookmarklet
*	http://koggdal.com/extras/link-adder/
*
*	by Johannes Koggdal, 2010
*	http://koggdal.com/
*/
(function(k,n,d){var g={id:"link-adder",plugin_folder:"http://koggdal.com/wp/wp-content/plugins/link-adder/",hash:""};if(n.getElementById(g.id+"_bg")!==null){n.body.removeChild(n.getElementById(g.id+"_bg"));n.body.removeChild(n.getElementById(g.id));n.removeEventListener("keydown",f,false)}var e=function(s){var r=s.replace(new RegExp("^[\\s]+","g"),"");r=r.replace(new RegExp("[\\s]+$","g"),"");return r},i=function(s){var u=false,r="";for(var t=0;t<s.length;t++){if(s.charAt(t)=="<"){u=true;continue}if(s.charAt(t)==">"){u=false;continue}if(!u){r+=s.charAt(t)}}r=r.replace("\n","").replace("\t","");return r},m=function(s){var v=["&amp;"],u=["&"],r=s;for(var t=0;t<v.length;t++){r=r.replace(v[t],u[t])}return r},q={bg:n.createElement("div"),form:n.createElement("form"),fieldset:n.createElement("fieldset"),heading:n.createElement("h1"),label_title:n.createElement("label"),input_title:n.createElement("input"),label_url:n.createElement("label"),input_url:n.createElement("input"),label_description:n.createElement("label"),textarea_description:n.createElement("textarea"),submit:n.createElement("button"),cancel:n.createElement("button"),post:n.createElement("script")},p={bg:{width:"100%",height:"100%",position:"fixed",zIndex:"99998",top:"0",left:"0",background:"rgba(0,0,0,0.8)"},form:{position:"fixed",zIndex:"99999",top:"-300px",left:(k.innerWidth-500)/2+"px",width:"500px",margin:"0 auto",padding:"20px",background:"#fff",WebkitBorderRadius:"0 0 10px 10px",MozBorderRadius:"0 0 10px 10px",borderRadius:"0 0 10px 10px",font:"14px/1 Helvetica Neue,Arial,Helvetica,sans-serif"},fieldset:{border:"0",margin:"0",padding:"0"},heading:{font:"bold 22px/1 Helvetica Neue,Arial,Helvetica,sans-serif",letterSpacing:"0",color:"#000000",margin:"0 0 20px 0"},label_title:{cssFloat:"left",width:"80px",color:"#000",margin:"0",padding:"0"},input_title:{width:"408px",margin:"0",padding:"5px",background:"#fff",WebkitBorderRadius:"3px",MozBorderRadius:"3px",borderRadius:"3px",border:"1px solid #dedede",fontSize:"14px",WebkitBoxSizing:"content-box",MozBoxSizing:"content-box",boxSizing:"content-box",WebkitBoxShadow:"none",MozBoxShadow:"none",boxShadow:"none"},textarea_description:{width:"408px",margin:"0",padding:"5px",background:"#fff",WebkitBorderRadius:"3px",MozBorderRadius:"3px",borderRadius:"3px",border:"1px solid #dedede",fontSize:"14px",WebkitBoxSizing:"content-box",MozBoxSizing:"content-box",boxSizing:"content-box",WebkitBoxShadow:"none",MozBoxShadow:"none",boxShadow:"none"},submit:{display:"block",margin:"20px 10px 0 0",padding:"3px 8px",border:"1px solid #298CBA",background:"#21759B",color:"#ffffff",WebkitBorderRadius:"11px",MozBorderRadius:"11px",borderRadius:"11px",cursor:"pointer",fontSize:"14px",WebkitBoxShadow:"none",MozBoxShadow:"none",boxShadow:"none",cssFloat:"left"},cancel:{display:"block",margin:"20px 0 0 0",padding:"3px 8px",border:"1px solid #bababa",background:"#9b9b9b",color:"#ffffff",WebkitBorderRadius:"11px",MozBorderRadius:"11px",borderRadius:"11px",cursor:"pointer",fontSize:"14px",WebkitBoxShadow:"none",MozBoxShadow:"none",boxShadow:"none"}};p.label_url=p.label_description=p.label_title;p.input_url=p.input_title;for(var h in p){for(var b in p[h]){q[h].style[b]=p[h][b]}}q.bg.id=g.id+"_bg";q.form.id=g.id;q.heading.innerHTML="Add Link to %SITENAME%";q.label_title.innerHTML="Title";q.label_url.innerHTML="URL";q.label_description.innerHTML="Description";q.submit.innerHTML="Add link";q.submit.setAttribute("type","button");q.cancel.innerHTML="Cancel";q.cancel.setAttribute("type","button");var c=function(y,D,x,u,v){x=x||1000;u=u||30;var s=[],t=[],r=[],z=[],B=[];for(var C in D){B.push(C);s.push(parseInt(y.style[C]));t.push(parseInt(D[C]));z.push(parseInt(y.style[C]));r.push(parseInt((D[C])-parseInt(y.style[C]))/(u/1000*x))}var A=B.length,w=function(){for(var E=B.length;E--;){if(s[E]<t[E]&&z[E]>=t[E]){A--;continue}else{if(s[E]>t[E]&&z[E]<=t[E]){A--;continue}}z[E]+=r[E];if(z[E]>=t[E]&&s[E]<t[E]){z[E]=t[E]}else{if(z[E]<=t[E]&&s[E]>t[E]){z[E]=t[E]}}y.style[B[E]]=z[E]+(B[E]=="opacity"?"":"px")}if(A>0){setTimeout(w,1000/u)}else{if(v!==d){v()}}};w()},l=function(){c(q.form,{top:0},250,60)},a=function(){c(q.form,{top:-300},250,60,function(){o()})},o=function(){n.body.removeChild(n.getElementById(g.id+"_bg"));n.body.removeChild(n.getElementById(g.id));n.removeEventListener("keydown",f,false)},f=function(r){if(r.keyCode==27||r.which==27){a()}};q.submit.addEventListener("click",function(){q.post.setAttribute("src",g.plugin_folder+"link-adder_add.php?title="+q.input_title.value+"&url="+q.input_url.value+"&description="+q.textarea_description.value+"&hash="+g.hash);n.getElementById(g.id).appendChild(q.post);a()},false);q.cancel.addEventListener("click",a,false);q.bg.addEventListener("click",a,false);n.addEventListener("keydown",f,false);var j=n.getElementsByTagName("h1");q.input_title.value=j.length>0?e(m(i(j[0].innerHTML))):"";q.input_url.value=k.location;q.form.appendChild(q.fieldset);q.fieldset.appendChild(q.heading);q.fieldset.appendChild(q.label_title);q.fieldset.appendChild(q.input_title);q.fieldset.appendChild(q.label_url);q.fieldset.appendChild(q.input_url);q.fieldset.appendChild(q.label_description);q.fieldset.appendChild(q.textarea_description);q.fieldset.appendChild(q.submit);q.fieldset.appendChild(q.cancel);n.body.appendChild(q.bg);n.body.appendChild(q.form);l()})(window,document);